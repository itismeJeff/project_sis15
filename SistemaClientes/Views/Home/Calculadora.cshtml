@{
    ViewData["Title"] = "Calculadora";
}

<div class="text-center">
    <h1 class="display-4">Calculadora</h1>
    <p class="lead">Realiza operaciones aritméticas básicas</p>
</div>

<div class="row justify-content-center">
    <div class="col-md-6">
        <div class="card">
            <div class="card-header">
                <h5>Calculadora Aritmética</h5>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <input type="text" class="form-control form-control-lg text-end" id="display" readonly value="0">
                </div>
                
                <div class="row mb-2">
                    <div class="col-3">
                        <button class="btn btn-secondary btn-lg w-100" onclick="limpiar()">C</button>
                    </div>
                    <div class="col-3">
                        <button class="btn btn-secondary btn-lg w-100" onclick="borrar()">←</button>
                    </div>
                    <div class="col-3">
                        <button class="btn btn-warning btn-lg w-100" onclick="operacion('+')">+</button>
                    </div>
                    <div class="col-3">
                        <button class="btn btn-warning btn-lg w-100" onclick="operacion('-')">-</button>
                    </div>
                </div>
                
                <div class="row mb-2">
                    <div class="col-3">
                        <button class="btn btn-info btn-lg w-100" onclick="numero('7')">7</button>
                    </div>
                    <div class="col-3">
                        <button class="btn btn-info btn-lg w-100" onclick="numero('8')">8</button>
                    </div>
                    <div class="col-3">
                        <button class="btn btn-info btn-lg w-100" onclick="numero('9')">9</button>
                    </div>
                    <div class="col-3">
                        <button class="btn btn-warning btn-lg w-100" onclick="operacion('*')">×</button>
                    </div>
                </div>
                
                <div class="row mb-2">
                    <div class="col-3">
                        <button class="btn btn-info btn-lg w-100" onclick="numero('4')">4</button>
                    </div>
                    <div class="col-3">
                        <button class="btn btn-info btn-lg w-100" onclick="numero('5')">5</button>
                    </div>
                    <div class="col-3">
                        <button class="btn btn-info btn-lg w-100" onclick="numero('6')">6</button>
                    </div>
                    <div class="col-3">
                        <button class="btn btn-warning btn-lg w-100" onclick="operacion('/')">÷</button>
                    </div>
                </div>
                
                <div class="row mb-2">
                    <div class="col-3">
                        <button class="btn btn-info btn-lg w-100" onclick="numero('1')">1</button>
                    </div>
                    <div class="col-3">
                        <button class="btn btn-info btn-lg w-100" onclick="numero('2')">2</button>
                    </div>
                    <div class="col-3">
                        <button class="btn btn-info btn-lg w-100" onclick="numero('3')">3</button>
                    </div>
                    <div class="col-3">
                        <button class="btn btn-success btn-lg w-100" onclick="calcular()">=</button>
                    </div>
                </div>
                
                <div class="row">
                    <div class="col-6">
                        <button class="btn btn-info btn-lg w-100" onclick="numero('0')">0</button>
                    </div>
                    <div class="col-6">
                        <button class="btn btn-info btn-lg w-100" onclick="numero('.')">.</button>
                    </div>
                </div>
                
                <div class="mt-3">
                    <div class="alert alert-info">
                        <strong>Nota:</strong> El resultado de cada operación se resta automáticamente 10.
                    </div>
                </div>
                
                <div id="resultado" class="mt-3"></div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        let displayValue = '0';
        let operador = '';
        let primerNumero = 0;
        let nuevoNumero = true;

        function actualizarDisplay() {
            document.getElementById('display').value = displayValue;
        }

        function numero(num) {
            if (nuevoNumero) {
                displayValue = num;
                nuevoNumero = false;
            } else {
                if (num === '.' && displayValue.includes('.')) return;
                displayValue += num;
            }
            actualizarDisplay();
        }

        function operacion(op) {
            if (operador && !nuevoNumero) {
                calcular();
            }
            primerNumero = parseFloat(displayValue);
            operador = op;
            nuevoNumero = true;
        }

        function calcular() {
            if (!operador || nuevoNumero) return;
            
            const segundoNumero = parseFloat(displayValue);
            let resultado = 0;
            let operacionRealizada = '';
            
            try {
                switch (operador) {
                    case '+':
                        resultado = primerNumero + segundoNumero;
                        operacionRealizada = 'Suma';
                        break;
                    case '-':
                        resultado = primerNumero - segundoNumero;
                        operacionRealizada = 'Resta';
                        break;
                    case '*':
                        resultado = primerNumero * segundoNumero;
                        operacionRealizada = 'Multiplicación';
                        break;
                    case '/':
                        if (segundoNumero === 0) {
                            mostrarError('Error: División por cero no está permitida');
                            return;
                        }
                        resultado = primerNumero / segundoNumero;
                        operacionRealizada = 'División';
                        break;
                }
                
                // Restar 10 al resultado como especifica el requerimiento
                const resultadoFinal = resultado - 10;
                
                mostrarResultado(operacionRealizada, primerNumero, segundoNumero, operador, resultado, resultadoFinal);
                
                displayValue = resultadoFinal.toString();
                operador = '';
                nuevoNumero = true;
                actualizarDisplay();
                
            } catch (error) {
                mostrarError('Error en el cálculo: ' + error.message);
            }
        }

        function mostrarResultado(operacion, num1, num2, op, resultadoOriginal, resultadoFinal) {
            const colores = {
                'Suma': 'success',
                'Resta': 'danger',
                'Multiplicación': 'warning',
                'División': 'info'
            };
            
            const color = colores[operacion] || 'primary';
            
            const html = `
                <div class="alert alert-${color}">
                    <strong>${operacion}:</strong> ${num1} ${op} ${num2} = ${resultadoOriginal}<br>
                    <strong>Resultado final (resta 10):</strong> ${resultadoFinal}
                </div>
            `;
            
            document.getElementById('resultado').innerHTML = html;
        }

        function mostrarError(mensaje) {
            const html = `
                <div class="alert alert-danger">
                    <strong>Error:</strong> ${mensaje}
                </div>
            `;
            document.getElementById('resultado').innerHTML = html;
        }

        function limpiar() {
            displayValue = '0';
            operador = '';
            primerNumero = 0;
            nuevoNumero = true;
            actualizarDisplay();
            document.getElementById('resultado').innerHTML = '';
        }

        function borrar() {
            if (displayValue.length > 1) {
                displayValue = displayValue.slice(0, -1);
            } else {
                displayValue = '0';
                nuevoNumero = true;
            }
            actualizarDisplay();
        }
    </script>
} 